# 주문 (Order) 기능 요구사항

## 개요

카페 키오스크의 주문과 관련된 기능을 정의합니다. 사용자는 주문 목록에 원하는 음료를 추가하거나 삭제할 수 있으며, 전체 주문을 취소할 수도 있습니다. 주문이 완료되면 총 금액을 계산하고, 현재 시간을 기준으로 고유한 주문 번호와 함께 새로운 주문을 생성합니다. 생성된 주문은 '접수' 상태가 되며, 이후 '처리 완료' 등 다양한 상태로 변경될 수 있습니다.

# 요구사항

- 주문 목록에 음료 추가/삭제
- 주문 목록에 담긴 음료의 개수를 변경할 수 있다.
- 음료의 개수는 1개 이상이어야 한다.
- 주문 목록 전체 지우기
- 주문 목록 총 금액 계산하기
- 주문 생성하기
- 주문 생성 시, 현재 시간을 기준으로 생성
- 주문 상태 관리 (주문 접수, 처리 완료 등)
- 주문 번호 생성

# 테스트 시나리오

- **주문 생성:**
    - [ ] 여러 개의 상품으로 주문을 생성할 수 있다.
    - [ ] 주문 생성 시 주문 상태는 '주문 접수'가 된다.
    - [ ] 주문 생성 시 주문 시간과 주문 번호가 올바르게 기록된다.
- **주문 목록 관리:**
    - [ ] 주문 목록에 상품을 추가할 수 있다.
    - [ ] 주문 목록에서 특정 상품을 삭제할 수 있다.
    - [ ] 주문 목록의 모든 상품을 삭제할 수 있다.
    - [ ] 주문 목록에 담긴 상품의 개수를 변경할 수 있다.
    - [ ] 상품 개수를 0개 이하로 변경하려고 하면 예외가 발생한다.
- **금액 계산:**
    - [ ] 주문 목록에 있는 모든 상품의 총 금액을 올바르게 계산한다.

# 완료된 일

### Phase 3: 주문 기능 구현 (TDD) - 주문 생성 (2026-01-08)
- [x] API 명세 정의: `openapi/cafe-kiosk-api-v1.yaml`에 주문 생성 API 명세 추가
- [x] API 코드 생성: 빌드하여 `OrderApi`, 관련 모델 등 생성
- [x] API 계층 구현: `OrderApiDelegateImpl` 클래스 생성 및 `OrderApiDelegate` 인터페이스 구현, 주문 생성 API 컨트롤러 테스트 코드 작성
- [x] 도메인 계층 구현: `Order`, `OrderProduct` 엔티티 및 `OrderRepository` 인터페이스 정의, 주문 상태(`OrderStatus`) Enum 클래스 정의, 주문 생성 서비스 테스트 코드 작성, `OrderService` 클래스 생성 및 비즈니스 로직 구현
- [x] Liquibase 설정: `orders`, `order_product` 테이블 생성을 위한 `changelog` 파일 작성
